<!doctype html>
<html lang=en>
<head>
  <meta charset=utf-8>
  <link href='http://fonts.googleapis.com/css?family=Cabin:bold' rel='stylesheet' type='text/css'>
  <title>Can I Park?</title>
  <link href="index.css" rel=stylesheet type=text/css>
  <script type="text/javascript" src="js/GeoLoc.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
  <script type=text/javascript>
    function glSuccess(position) {
      var heading = directionFromBearing(position.coords.heading);
      if (!heading) {
        /* no movement */
        heading = 'N'; /* dummy val */
      }

      $.ajax({
        url: "parking_spots",
        data: {
          "latitude": position.coords.latitude,
          "longitude": position.coords.longitude,
          "heading": heading
        },
        success: function(result) {
          $("#lefticon").addClass(result.left.flag);
          $("#righticon").addClass(result.right.flag);
          $("#streetsign").text(result.streetname);

          if (result.left.message) {
            $("#sidearrow").text(result.left.message);
          } else if (result.right.message) {
            $("#sidearrow").text(result.right.message);
          }
        },
        failure: function(result) {
          alert("aww, snap!");
        }
      })
    }

    function glUnsupported() {
      /* return heading based on positioning */
      return;
    }

    function glFailure() {
      /* failboat */
      return;
    }

    $(document).ready(getLocation(glSuccess, glUnsupported, glFailure));
  </script>
</head>
<body>
	<div id="sidearrow"></div>
	<div class="centerline" id="one"></div>
	<div class="centerline" id="two"></div>
	<div id="parkinginfo"></div>
	<div class="icon" id="lefticon"></div>
	<div class="icon" id="righticon"></div>
	<div id="streetsign">Random St.</div>
	<div id="streetsignpost"></div>
</body>
</html>

